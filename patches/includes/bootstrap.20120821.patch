*** a/includes/bootstrap.inc	2012-05-03 01:59:43.000000000 +0200
--- b/includes/bootstrap.inc	2012-08-21 09:49:32.574984292 +0200
***************
*** 733,738 ****
--- 733,739 ----
  
    $result = $forced_cache
      && !drupal_session_started()
+     && isset($_SERVER['REQUEST_METHOD'])
      && ($_SERVER['REQUEST_METHOD'] == 'GET' || $_SERVER['REQUEST_METHOD'] == 'HEAD')
      && !count(drupal_get_messages(NULL, FALSE))
      && !drupal_is_cli();
***************
*** 1153,1159 ****
    // @todo remove this when support for either IE6 or PHP < 5.2.5 is dropped.
  
    if ($php525) {
!     return htmlspecialchars($text, ENT_QUOTES, 'UTF-8');
    }
    return (preg_match('/^./us', $text) == 1) ? htmlspecialchars($text, ENT_QUOTES, 'UTF-8') : '';
  }
--- 1154,1160 ----
    // @todo remove this when support for either IE6 or PHP < 5.2.5 is dropped.
  
    if ($php525) {
!     return @htmlspecialchars($text, ENT_QUOTES, 'UTF-8');
    }
    return (preg_match('/^./us', $text) == 1) ? htmlspecialchars($text, ENT_QUOTES, 'UTF-8') : '';
  }
***************
*** 1678,1684 ****
    static $ip_address = NULL;
  
    if (!isset($ip_address)) {
!     $ip_address = $_SERVER['REMOTE_ADDR'];
      
      // Only use parts of the X-Forwarded-For (XFF) header that have followed a trusted route.
      // Specifically, identify the leftmost IP address in the XFF header that is not one of ours.
--- 1679,1685 ----
    static $ip_address = NULL;
  
    if (!isset($ip_address)) {
!     $ip_address = isset($_SERVER['REMOTE_ADDR'])?$_SERVER['REMOTE_ADDR']:'0.0.0.0';
      
      // Only use parts of the X-Forwarded-For (XFF) header that have followed a trusted route.
      // Specifically, identify the leftmost IP address in the XFF header that is not one of ours.
